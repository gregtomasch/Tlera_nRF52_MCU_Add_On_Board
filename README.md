# Bring BLE Connectivity to Your Favorite MCU Development Board With Tlera nRF52832 Add-on Boards

## Background
Microcontroller (MCU) development boards are widely used for many Internet of Things (IoT) applications. They are compact, powerful and highly versatile with a wide range of I/O capabilities. The PJRC Teensy3.X family of products are highly capable and very popular. These were some of the first MCU development boards that brought transformative performance to the IoT Maker community in small form factor and at a reasonable price. Tlera Corporation offers a [family of MCU development boards](https://www.tindie.com/stores/TleraCorp/) that were initially inspired by the Teensy3.2 but are based upon [ST Microelectronics' STM32L4 microcontroller.](http://www.st.com/content/ccc/resource/technical/document/reference_manual/02/35/09/0c/4f/f7/40/03/DM00083560.pdf/files/DM00083560.pdf/jcr:content/translations/en.DM00083560.pdf)![alt text](https://user-images.githubusercontent.com/5760946/35936194-677fc7dc-0bf7-11e8-8aba-164e4539fc1b.png)![alt text](https://user-images.githubusercontent.com/5760946/35936276-9dd7b4b6-0bf7-11e8-9f23-42b35ff0d7db.png)The STM32L4 is an 80MHz ARM Cortex M4 microcontroller with an embedded floating point unit and a very rich I/O portfolio. Like the Teensy3.X family, Tlera's MCU development boards are supported by a [mature Arduino core](https://github.com/GrumpyOldPizza/arduino-STM32L4) for easy application development. The differentiating advantage of the Tlera STM32L4-based MCU boards is low power sleep capability. State-preserving sleep modes can be easily implemented using the Arduino IDE and typically result in ~1.6uA current consumption. The STM32L4 can be woken up by either an external interrupt or periodically by using the internal RTC.

The combination of ample numerical processing speed, rich I/O capability, very low power sleep states and Arduino IDE support make the STM32L4 an excellent choice for developing battery-powered remote sensing devices. **However, one critical limitation has persisted: No integrated wireless connectivity.** In order to address this need, Tlera Corp. now offers an nRF5282 BLE board to bring wireless connectivity to your favorite MCU boards:![alt text](https://user-images.githubusercontent.com/5760946/35936401-033b6c76-0bf8-11e8-8e20-05b05b8464fb.png) This add-on product was specifically designed to plug directly into the Tlera ["Dragonfly"](https://www.tindie.com/products/TleraCorp/dragonfly-stm32l47696-development-board/) and ["Butterfly"](https://www.tindie.com/products/TleraCorp/butterfly-stm32l433-development-board/) MCU development boards and is also pinout compatible with the Teensy3.X family of products. The nRF5282 add-on board shares 3.3V power and ground connections with the MCU board. The UART serial Tx and Rx lines are connected in null modem configuration. An indicator pin is also available to connct with a digital input on the MCU board. When the nRF5282 pairs with another suitable BLE device, the "IND" node of the add-on board is pulled low. This feature is helpful to notify the MCU that there is a BLE connection before attempting to send data to the paired device.

Physical mounting of the add-on board to the MCU development board is straightforward:![alt text](https://user-images.githubusercontent.com/5760946/35993753-2254dba8-0cc3-11e8-9c2f-3617f0f20ac7.JPG) Machine pin headers are convenient to mate the add-on board with the MCU development board. In all cases (Dragonfly, Butterfly, Teensy 3.1/3.2 and Teensy 3.5/3.6) the connection pinout is identical.

## How the Connectivity Works and Use Case Options 
The add-on boards can be flashed to act as either a Peripheral or Central role BLE [Nordic UART Service](https://infocenter.nordicsemi.com/index.jsp?topic=%2Fcom.nordic.infocenter.sdk52.v0.9.0%2Fgroup__ble__sdk__srv__nus.html) (NUS) device. The NUS characteristic turns out to be extremely useful for enabling BLE wireless connectivity; it acts as a simple BLE-UART bridge. If the nRF52832 receives data from a paired BLE NUS device, it simply relays that data to the MCU over a UART port. Conversely, data written from the MCU to the nRF52832 over the UART port is sent immediately to the paired BLE NUS device. So one could think of the NUS as a virtual "BLE Serial extension cable" connecting two UART ports... 

There are a number of [NUS BLE Central role applications](https://learn.adafruit.com/bluefruit-le-connect-for-ios/ios-setup) for smart devices such as cell phones and tablet computers. It is simple to use the nRF5282 add-on in Peripheral role to stream serial data from an MCU to a Central role smart device. However, it has proven to be much harder to establish BLE connectivity between a remote MCU device a PC. This problem can be easily solved by using a second MCU development board and a Central role nRF5282 add-on:

   * A serial bridge is made between the *remote* MCU device and a *Peripheral role* nRF5282 add-on
   * A second serial bridge is made between a *second* MCU device and a *Central role* nRF5282 add-on. We'll call this second MCU the
     *host*
   * 
   * The Central and Peripheral role add-ons pair and can exchage data between the remote 
